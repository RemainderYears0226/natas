<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>搜尋頁面</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<main>
<div class="search-container">
<input type="text" id="searchInput" placeholder="輸入關鍵字...">
<button id="searchButton">搜尋</button>
<div id="searchResults"></div>
</div>
</main>
<footer>
<button id="homeButton" class="bottom-button" onclick="window.location.href='index.html'">主頁</button>
<button id="searchPageButton" class="bottom-button" onclick="window.location.href='search.html'">搜尋頁面</button>
</footer>
<script>
// 第一段: 搜尋功能
const searchInput = document.getElementById('searchInput');
const searchButton = document.getElementById('searchButton');
const searchResults = document.getElementById('searchResults');

// 假設的临时数据库
const tempDatabase = [
  '這是第一筆資料jimmy',
  '這是包含關鍵字的第二筆資料',
  '第三筆資料也包含了關鍵字',
  '這是最後一筆資料'
];

searchButton.addEventListener('click', () => {
  const searchTerm = searchInput.value.trim().toLowerCase();
  if (searchTerm) {
    searchResults.innerHTML = '';

    // 檢查是否包含 SQL 注入
    const isSqlInjection = checkForSqlInjection(searchTerm);

    if (isSqlInjection) {
      // 如果是 SQL 注入，直接使用 SQL 注入后面的关键字进行实际搜索
      const injectedTerm = searchTerm.split(' ')[1]; // 获取 SQL 注入后面的关键字
      const matchedResults = tempDatabase.filter(result =>
        result.toLowerCase().includes(injectedTerm)
      );
      displayResults(matchedResults);
    } else {
      // 如果不是 SQL 注入，进行一般搜索
      const searchKeyword = searchTerm.split(' ')[1]; // 获取搜索关键字
      const filteredResults = tempDatabase.filter(result =>
        result.toLowerCase().includes(searchKeyword) && !result.toLowerCase().includes('jimmy')
      );
      if (filteredResults.length > 0) {
        displayResults(filteredResults);
      } else {
        searchResults.innerHTML = '<p>沒有符合的搜尋結果</p>';
      }
    }
  } else {
    searchResults.innerHTML = '<p>請輸入關鍵字</p>';
  }
});

function displayResults(results) {
  results.forEach(result => {
    const resultElement = document.createElement('p');
    resultElement.textContent = result;
    searchResults.appendChild(resultElement);
  });
}

function checkForSqlInjection(searchTerm) {
  // 在这里检查是否包含 SQL 注入的逻辑，这里只是一个示例
  // 你可以根据你的需求来检查是否包含 SQL 注入的字符
  // 这里假设包含 ' or '1'='1' 为 SQL 注入
  return searchTerm.includes("or '1'='1'");
}

</script>
</body>
</html>
